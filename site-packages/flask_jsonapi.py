from flask import abort, request
from flask_json import json_response
from json_api.containers import Container

__all__ = ['FieldError', 'FormError', 'JsonForm', 'BaseForm']


class BaseForm(Container):
    def __init__(self, data=None):
        if data is None and BaseForm.is_submitted():
            data = request.get_json()
        try:
            super().__init__(data=data)
        except FormError as e:
            abort(json_response(status_=400, data_=e))

    @staticmethod
    def is_submitted():
        return bool(request)
